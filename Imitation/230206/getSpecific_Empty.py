import usb.core
import usb.util
import os
import usb.backend.libusb1
import time

#Func
def send(command, ep_out, ep_in):
	dev.write(ep_out, command)
	try:
		res = dev.read(ep_in, 100000, 1000)
		print(res)
	except:
		pass

#main
backend = usb.backend.libusb1.get_backend()
print("[*]Configuration")
dev = usb.core.find(idVendor=0x04E8, idProduct=0x6860, backend=backend)
cfg = dev.get_active_configuration()
intf = cfg[(0, 0)]
ep_out = intf[1]
ep_in = intf[0]
print("[*]mtp-connection")
os.system('mtp-connect')

print("[*]Start App")
send(bytearray.fromhex("10000000010003950a00000003000000"), ep_out, ep_in)
send(bytearray.fromhex("1b000000020003950a000000010000000000000000000000010000"), ep_out, ep_in)
send(bytearray.fromhex("10000000010001950f000000ffffffff"), ep_out, ep_in)
send(bytearray.fromhex("e7000000020001950f00000066347171366a344f627841424f3171336d6932643650366e5262544a77645244653951347936305a6b726f596b6865654636614b645a556569504f38766252647a5559376f4a35610a6d7059486a3048354a665a52786c363357334c324b4d496d714d6d4762384f4666366942353169686a65516d6d6248786748457365775952634f354f3165574f4e376c612f732b720a37474757324d464f593972752b316957683465443435476c5037446d344c2f4c30336d4346586977566a4e445377454c757a31664b5153684c5a4a336a73704a5676554c34513d3d0a"), ep_out, ep_in)
print("[*]Request to create Backup File")
time.sleep(3)
send(bytearray.fromhex("0c00000001000195e7000000"), ep_out, ep_in)
send(bytearray.fromhex("e700000002000195e7000000734c3666734f643070506c6d3859463466374d6a776735474d734d627267696a776476382b76714d64652b647955334f52554274476c4b766239535964455436664a715a394742780a744d6536506337356c72454253736746477a6f4d4a6e6b69424a4f346c6c2b584f796146452f554c72666530573649394242413367357631326a316f6b4b534a6938496e4577554f0a5a4836766735615a6c536455516e365a79423853553156642b33704e5853514b43703059424d524835754c6a736b316853316449534d7373386b6e545339454f34554e7976413d3d0a"), ep_out, ep_in)

print("[*]Request to Specific Backup Items") #Empty
send(bytearray.fromhex("e70000000200019594ac00004864477a64764d51333838586e765930715553724e3957666a793267634867617a6535704a5643384c79784e716a614164365770735435673961586f77787778365461432b3449760a513462705335424843444f6f625547546a567a557167677134776748565a64634d44466636396f7a386a2b6567476d4a79436f42544d713471562b70707a37784c345532514136300a536b533956713976304239744867376b3474725539366646773649527351305362366e73466d63787470546b784a6b706e593135304b6847694a6a744474626d637561527a413d3d0a"), ep_out, ep_in)
#
send(bytearray.fromhex("e700000002000195a3ae00004864477a64764d51333838586e765930715553724e3957666a793267634867617a6535704a5643384c79784e716a614164365770735435673961586f77787778365461432b3449760a513462705335424843444f6f625547546a567a557167677134776748565a64634d4448374549764d367a724b74416346766c6c2b77556452492f66587968714c4f736f323552654a0a75756b304f374e316e6854586b624d6a582f554d726a70706564716958666c635566432f316f4e6262346d594d7a6d54615a68503733434f74594f67797046786b712f376a413d3d0a"), ep_out, ep_in)

print("[*]Done")
#send(bytearray.fromhex(""), ep_out, ep_in)